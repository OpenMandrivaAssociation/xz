diff -Naur xz-5.2.4/Makefile.am xz-5.2.4.tpg/Makefile.am
--- xz-5.2.4/Makefile.am	2018-04-29 15:10:38.000000000 +0000
+++ xz-5.2.4.tpg/Makefile.am	2019-03-26 19:12:45.140000000 +0000
@@ -108,3 +108,13 @@
 	fi; \
 	TAR_OPTIONS='--owner=0 --group=0 --numeric-owner --mode=u+rw,go+r-w' \
 		$(MAKE) VERSION="$$VERSION" dist-gzip
+
+PGO_DIR="pgo"
+PGO_GEN_CFLAGS=-fprofile-generate -fprofile-dir=`realpath ${PGO_DIR}`
+PGO_USE_CFLAGS=-fprofile-use -fprofile-dir=`realpath ${PGO_DIR}`
+pgo-build:
+       $(MKDIR_P) ${PGO_DIR}
+       $(MAKE) clean
+       $(MAKE) check CFLAGS="${CFLAGS} ${PGO_GEN_CFLAGS}" CXXFLAGS="${CXXFLAGS} ${PGO_GEN_CFLAGS}" LDFLAGS="${LDFLAGS} ${PGO_GEN_CFLAGS}"
+       $(MAKE) clean
+       $(MAKE) check CFLAGS="${CFLAGS} ${PGO_USE_CFLAGS}" CXXFLAGS="${CXXFLAGS} ${PGO_USE_CFLAGS}" LDFLAGS="${LDFLAGS} ${PGO_USE_CFLAGS}"
